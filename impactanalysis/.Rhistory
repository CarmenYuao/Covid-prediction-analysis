abline(v=stayathome,col="grey",lty="dashed", lwd=2)
time = 1:zoom.length
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
adf.test(zoom.ts[1:(stayathome-4)])
adf.test(log(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome:zoom.length] <- (stayathome:zoom.length) - (stayathome-1)
time = 1:zoom.length
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
m
runif(10)
runif(10) * 10
knitr::opts_chunk$set(echo = TRUE)
library(TSA)
library(urca)
library(tseries)
zoom.ch <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom.isr <- read.csv(file="../data/impact/zoomISR")
zoom.ch <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom.isr <- read.csv(file="../data/impact/zoomISR.csv")
zoom.ch <- zoom.ch[(1:min(which(zoom.ch[,1] >= "2022-01-01"))-1),]
zoom.isr <- zoom.isr[(1:min(which(zoom.isr[,1] >= "2022-01-01"))-1),]
zoom.ts.ch <- ts(zoom.ch[,2])
zoom.ts.isr <- ts(zoom.isr[,2])
zoom.ch <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom.isr <- read.csv(file="../data/impact/zoomISR.csv")
zoom.ch <- zoom.ch[(1:min(which(zoom.ch[,1] >= "2022-01-01"))-1),]
zoom.isr <- zoom.isr[(1:min(which(zoom.isr[,1] >= "2022-01-01"))-1),]
zoom.ts.ch <- ts(zoom.ch[,2])
zoom.ts.isr <- ts(zoom.isr[,2])
zoom.length <- dim(zoom.ch)[1]
stayathome.ch <- min(which(zoom[,1] >= "2020-03-16"))-1
zoom.ch <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom.isr <- read.csv(file="../data/impact/zoomISR.csv")
zoom.ch <- zoom.ch[(1:min(which(zoom.ch[,1] >= "2022-01-01"))-1),]
zoom.isr <- zoom.isr[(1:min(which(zoom.isr[,1] >= "2022-01-01"))-1),]
zoom.ts.ch <- ts(zoom.ch[,2])
zoom.ts.isr <- ts(zoom.isr[,2])
zoom.length <- dim(zoom.ch)[1]
stayathome.ch <- min(which(zoom.ch[,1] >= "2020-03-16"))-1
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
line(zoom.ts.isr)
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
points(zoom.ts.isr)
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.isr)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
zoom.ch <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom.isr <- read.csv(file="../data/impact/zoomISR.csv")
zoom.ch <- zoom.ch[(1:min(which(zoom.ch[,1] >= "2022-01-01"))-1),]
zoom.isr <- zoom.isr[(1:min(which(zoom.isr[,1] >= "2022-01-01"))-1),]
zoom.ts.ch <- ts(zoom.ch[,2])
zoom.ts.isr <- ts(zoom.isr[,2])
zoom.length <- dim(zoom.ch)[1]
stayathome.ch <- min(which(zoom.ch[,1] >= "2020-03-16"))-1
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.isr)
zoom.ch <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom.isr <- read.csv(file="../data/impact/zoomISR.csv")
zoom.ch <- zoom.ch[(1:min(which(zoom.ch[,1] >= "2022-01-01"))-1),]
zoom.isr <- zoom.isr[(1:min(which(zoom.isr[,1] >= "2022-01-01"))-1),]
zoom.ts.ch <- ts(zoom.ch[,2])
zoom.ts.isr <- ts(zoom.isr[,2])
zoom.length <- dim(zoom.ch)[1]
stayathome.ch <- min(which(zoom.ch[,1] >= "2020-03-16"))-1
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
line(zoom.ts.isr)
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.isr)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
lines(zoom.ts.isr)
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
lines(zoom.ts.isr)
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
lines(zoom.ts.isr,col="red")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
? legend
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend(legend=c("ISR","CH"))
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend("topleft",legend=c("ISR","CH"),col=c("blue","red"))
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend("topleft",legend=c("ISR","CH"),col=c("blue","red"),lty=2)
plot(zoom.ts.ch, ylim=c(0,105),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend("topleft",legend=c("ISR","CH"),col=c("blue","red"),lwd=2)
plot(log(zoom.ts.ch),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr.isr,col="blue")
plot(log(zoom.ts.ch),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
plot(log(zoom.ts.ch),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(log(zoom.ts.ch),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend("topleft",legend=c("ISR","CH"),col=c("blue","red"),lwd=2)
plot(log(zoom.ts.ch),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n",ylim=c(0,10))
lines(zoom.ts.isr,col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend("topleft",legend=c("ISR","CH"),col=c("blue","red"),lwd=2)
plot(log(zoom.ts.ch),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
lines(log(zoom.ts.isr),col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend("topleft",legend=c("ISR","CH"),col=c("blue","red"),lwd=2)
plot(log(zoom.ts.ch),type="l",col="red", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n",ylim=c(0,5))
lines(log(zoom.ts.isr),col="blue")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
legend("topleft",legend=c("ISR","CH"),col=c("blue","red"),lwd=2)
adf.test(zoom.ts.ch)
adf.test(log(zoom.ts.ch))
summary(ur.kpss(zoom.ts.ch))
summary(ur.kpss(log(zoom.ts.ch)))
adf.test(zoom.ts.ch[1:(stayathome.ch-4)])
adf.test(log(zoom.ts.ch[1:(stayathome.ch-4)]))
summary(ur.kpss(zoom.ts.ch[1:(stayathome.ch-4)]))
summary(ur.kpss(log(zoom.ts.ch[1:(stayathome.ch-4)])))
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
step <- rep(0,zoom.length)
step[stayathome.ch:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome.ch] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome.ch:zoom.length] <- (stayathome.ch:zoom.length) - (stayathome.ch-1)
time = 1:zoom.length
m<-arimax(log(zoom.ts.ch), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
m
plot(fitted(m), col="red")
lines(log(zoom.ts.ch), col="blue")
plot(fitted(m), col="black",lty=".")
plot(fitted(m), col="black",lty=2)
lines(log(zoom.ts.ch), col="blue")
plot(m$residuals,ylab="residuals", xlab="weeks",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
plot(m$residuals,ylab="residuals", xlab="weeks",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom.ch[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome.ch,col="grey",lty="dashed", lwd=2)
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 20, type = "Ljung-Box")
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 60, type = "Ljung-Box")
m.ar3<-arimax(log(zoom.ts.ch), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m.ar3
m.stable <- arimax(log(zoom.ts.ch), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m.stable
m.nocovid <- arimax(log(zoom.ts.ch[1:(stayathome.ch-4)]), order=c(0, 0, 0), xreg = data.frame(time[1:(stayathome.ch-4)]))
m.nocovid
summary(ur.kpss(m.nocovid$residuals))
m.season <- arimax(log(zoom.ts.ch), order=c(2, 0, 0), seasonal=list(order=c(1,0,0),period=52), xreg = data.frame(step, ramp,time))
m.season
confint(m.season)
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 80, type = "Ljung-Box")
1:10
1:10
length(1:10)
zoom.cut.isr<- zoom.ts.isr[stayathome.ch:zoom.length]
ramp <- 1:length((stayathome.ch:zoom.length))
length(ramp)
length(zoom.cut.isr)
zoom.cut.isr<- zoom.ts.isr[stayathome.ch:zoom.length]
ramp <- 1:length((stayathome.ch:zoom.length))
adf.test(zoom.cut.isr)
adf.test(zoom.cut.isr)
summary(ur.kpss(zoom.cut.isr))
summary(ur.kpss(log(zoom.cut.isr)))
adf.test(zoom.cut.isr)
adf.test(log(zoom.cut.isr))
summary(ur.kpss(zoom.cut.isr))
summary(ur.kpss(log(zoom.cut.isr)))
time <- 1:length(zoom.cut.isr)
m<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
time <- 1:length(zoom.cut.isr)
m<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(time))
m
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(1, 0, 0), xreg = data.frame(time))
m.isr
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(time))
m.isr
plot(fitted(m.isr), col="black",lty=2)
lines(log(zoom.cut.ch), col="blue")
plot(fitted(m.isr), col="black",lty=2)
lines(log(zoom.cut.isr), col="blue")
plot(m.isr$residuals,ylab="residuals", xlab="weeks",xaxt="n")
acf(resid(m)[-1],lag=20, main="residuals")
pacf(resid(m)[-1],lag=20, main="residuals")
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
acf(resid(m.isr)[-1],lag=50, main="residuals")
pacf(resid(m.isr)[-1],lag=50, main="residuals")
adf.test(m.isr$residuals)
summary(ur.kpss(m.isr$residuals))
Box.test(m.isr$residuals, lag = 60, type = "Ljung-Box")
adf.test(m.isr$residuals)
summary(ur.kpss(m.isr$residuals))
Box.test(m.isr$residuals, lag = 20, type = "Ljung-Box")
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(3, 0, 0), xreg = data.frame(time))
m.isr
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(time))
m.isr
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(1, 0, 1), xreg = data.frame(time))
m.isr
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(1, 0, 0), xreg = data.frame(time))
m.isr
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(time))
m.isr
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(time),seasonal=list(order=c(1,0,0),period=52))
time <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(time))
m.isr
confint(m.isr)
adf.test(m.isr$residuals)
summary(ur.kpss(m.isr$residuals))
Box.test(m.isr$residuals, lag = 20, type = "Ljung-Box")
ramp <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(ramp))
m.isr
plot(fitted(m.isr), col="black",lty=2)
lines(log(zoom.cut.isr), col="blue")
plot(m.isr$residuals,ylab="residuals", xlab="weeks",xaxt="n")
acf(resid(m.isr)[-1],lag=50, main="residuals")
pacf(resid(m.isr)[-1],lag=50, main="residuals")
acf(resid(m.isr)[-1],lag=50, main="residuals")
pacf(resid(m.isr)[-1],lag=50, main="residuals")
confint(m.isr)
adf.test(m.isr$residuals)
summary(ur.kpss(m.isr$residuals))
Box.test(m.isr$residuals, lag = 30, type = "Ljung-Box")
ramp <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(0, 0, 2), xreg = data.frame(ramp))
m.isr
ramp <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(0, 0, 3), xreg = data.frame(ramp))
m.isr
ramp <- 1:length(zoom.cut.isr)
m.isr<-arimax(log(zoom.cut.isr), order=c(2, 0, 0), xreg = data.frame(ramp))
m.isr
0.73 / 0.1012
0.4848 / 0.0613
193/35
212/56
confint(m.isr)
adf.test(m.isr$residuals)
summary(ur.kpss(m.isr$residuals))
Box.test(m.isr$residuals, lag = 30, type = "Ljung-Box")
adf.test(diff(zoom.cut.isr))
adf.test(diff(log(zoom.cut.isr)))
summary(ur.kpss(diff(zoom.cut.isr)))
summary(ur.kpss(diff(log(zoom.cut.isr))))
plot(diff(log(zoom.cut.isr)))
plot(diff(log(zoom.cut.isr)),type="l")
m.isr.try<-arimax(log(diff(zoom.cut.isr)), order=c(2, 0, 0))
m.isr.try<-arimax(diff(log(zoom.cut.isr)), order=c(2, 0, 0))
m.isr.try<-arimax(diff(log(zoom.cut.isr)), order=c(2, 0, 0))
m.isr.try
m.isr.try<-arimax(diff(log(zoom.cut.isr)), order=c(1, 0, 0))
m.isr.try
acf(diff(log(zoom.cut.isr)))
pacf(diff(log(zoom.cut.isr)))
acf(diff(log(zoom.cut.isr)),lag=50)
pacf(diff(log(zoom.cut.isr)),lag=50)
m.isr.try<-arimax(diff(log(zoom.cut.isr)), order=c(1, 0, 0))
m.isr.try
m.isr.try<-arimax(diff(log(zoom.cut.isr)), order=c(0, 0, 1))
m.isr.try
m.isr.try<-arimax(diff(log(zoom.cut.isr)), order=c(1, 0, 0))
m.isr.try
acf(resid(m.isr.try)[-1],lag=50, main="residuals")
pacf(resid(m.isr.try)[-1],lag=50, main="residuals")
confint(m.isr.try)
adf.test(m.isr.try$residuals)
summary(ur.kpss(m.isr.try$residuals))
Box.test(m.isr.try$residuals, lag = 50, type = "Ljung-Box")
acf(resid(m.isr.try)[-1],lag=50, main="residuals")
pacf(resid(m.isr.try)[-1],lag=50, main="residuals")
confint(m.isr.try)
adf.test(m.isr.try$residuals)
summary(ur.kpss(m.isr.try$residuals))
Box.test(m.isr.try$residuals, lag = 30, type = "Ljung-Box")
acf(resid(m.isr.try)[-1],lag=50, main="residuals")
pacf(resid(m.isr.try)[-1],lag=50, main="residuals")
confint(m.isr.try)
adf.test(m.isr.try$residuals)
summary(ur.kpss(m.isr.try$residuals))
Box.test(m.isr.try$residuals, lag = 60, type = "Ljung-Box")
acf(resid(m.isr.try)[-1],lag=50, main="residuals")
pacf(resid(m.isr.try)[-1],lag=50, main="residuals")
confint(m.isr.try)
adf.test(m.isr.try$residuals)
summary(ur.kpss(m.isr.try$residuals))
Box.test(m.isr.try$residuals, lag = 50, type = "Ljung-Box")
? arimax
knitr::opts_chunk$set(echo = TRUE)
ue.ch <- read.csv(file="../data/impact/unemploymentSwiss.csv")
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
head(ue.ch)
head(us.isr)
ue.ch <- read.csv(file="../data/impact/unemploymentSwiss.csv")
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
head(ue.ch)
head(ue.isr)
ue.ts.ch <- ts(ue.ch$Value)
us.ts.isr <- ts(ue.isr$Value)
ue.len <- length(ue.ts.ch)
intervention <- which(ue.ch$TIME == "2020-04")
plot(ue.ts.ch ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n")
lines(ue.ts.isr, col="blue")
ue.ch <- read.csv(file="../data/impact/unemploymentSwiss.csv")
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
head(ue.ch)
head(ue.isr)
ue.ts.ch <- ts(ue.ch$Value)
ue.ts.isr <- ts(ue.isr$Value)
ue.len <- length(ue.ts.ch)
intervention <- which(ue.ch$TIME == "2020-04")
plot(ue.ts.ch ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n")
lines(ue.ts.isr, col="blue")
axis(1, at=seq(1, ue.len),labels=ue.ch$TIME, cex.axis = 0.6, las="2",ylim=c(2,10))
abline(v=intervention,col="grey",lty="dashed", lwd=2)
abline(v=intervention-1,col="grey",lty="dashed", lwd=2)
plot(ue.ts.ch ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n",ylim=c(2,10))
lines(ue.ts.isr, col="blue")
axis(1, at=seq(1, ue.len),labels=ue.ch$TIME, cex.axis = 0.6, las="2")
abline(v=intervention,col="grey",lty="dashed", lwd=2)
abline(v=intervention-1,col="grey",lty="dashed", lwd=2)
ue.ts.ch
ue.ts.isr
library(TSA)
library(urca)
library(tseries)
ue.ch <- read.csv(file="../data/impact/unemploymentSwiss.csv")
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
head(ue.ch)
head(ue.isr)
ue.ts.ch <- ts(ue.ch$Value)
ue.ts.isr <- ts(ue.isr$Value)
ue.len <- length(ue.ts.ch)
intervention <- which(ue.ch$TIME == "2020-04")
plot(ue.ts.ch ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n",ylim=c(2,10))
lines(ue.ts.isr, col="blue")
axis(1, at=seq(1, ue.len),labels=ue.ch$TIME, cex.axis = 0.6, las="2")
abline(v=intervention,col="grey",lty="dashed", lwd=2)
abline(v=intervention-1,col="grey",lty="dashed", lwd=2)
library(TSA)
library(urca)
library(tseries)
ue.ch <- read.csv(file="../data/impact/unemploymentSwiss.csv")
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
head(ue.ch)
head(ue.isr)
ue.ts.ch <- ts(ue.ch$Value)
ue.ts.isr <- ts(ue.isr$Value)
ue.len <- length(ue.ts.ch)
intervention <- which(ue.ch$TIME == "2020-04")
dim(ue.ch)
dim(ue.isr)
knitr::opts_chunk$set(echo = TRUE)
ue<- read.csv(file="../data/impact/unemploymentSwiss.csv")
ue<- read.csv(file="../data/impact/unemploymentOECD.csv")
ue<- read.csv(file="../data/impact/unemploymentOECD.csv")
head(ue)
ue.ts <- ts(ue$Value)
ue.len <- length(ue.ts)
intervention <- which(ue$TIME == "2020-04")
plot(ue.ts ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n",ylim=c(2,10))
axis(1, at=seq(1, ue.len),labels=ue.ch$TIME, cex.axis = 0.6, las="2")
plot(ue.ts ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n",ylim=c(2,10))
axis(1, at=seq(1, ue.len),labels=ue$TIME, cex.axis = 0.6, las="2")
abline(v=intervention,col="grey",lty="dashed", lwd=2)
abline(v=intervention-1,col="grey",lty="dashed", lwd=2)
plot(log(ue.ts) ,type="l",col="blue", xlab="Month", ylab="log unemployment rate", main="OECD HUR",xaxt="n")
axis(1, at=seq(1, ue.len),labels=ue$TIME, cex.axis = 0.6, las="2")
abline(v=intervention,col="grey",lty="dashed", lwd=2)
abline(v=intervention-1,col="grey",lty="dashed", lwd=2)
adf.test(ue.ts)
library(TSA)
library(urca)
library(tseries)
adf.test(ue.ts)
# adf.test(log(ue.ts))
summary(ur.kpss(ue.ts))
# summary(ur.kpss(log(ue.ts)))
adf.test(diff(ue.ts))
summary(ur.kpss(diff(ue.ts)))
Box.test(diff(ue.ts),lag=5)
plot(diff(ue.ts),ylab="difference")
acf(diff(ue.ts))
pacf(diff(ue.ts))
step <- rep(0,ue.len)
step[intervention:ue.len] <- 1
pulse <- rep(0,ue.len)
pulse[intervention] <- 1
ramp <- rep(0, ue.len)
ramp[intervention:ue.len] <- (intervention:ue.len) - (intervention-1)
time <- 1:ue.len
m.basic <- arimax(diff(ue.ts), order=c(0,0,0))
m.basic
Box.test(resid(m.basic))
m.diff <- arimax(ue.ts, order=c(2,1,0), xreg = data.frame(step))
m.diff
acf(resid(m.diff), main="")
pacf(resid(m.diff), main="")
plot(resid(m.diff))
Box.test(resid(m.diff), type = "Ljung-Box", lag = 20)
m.itv <- arimax(ue.ts, order=c(1,0,0),seasonal = list(order=c(0,0,1), period=5), xreg = data.frame(step,time,ramp))
m.itv
acf(resid(m.itv))
pacf(resid(m.itv))
plot(resid(m.itv))
Box.test(resid(m.itv), type = "Ljung-Box", lag = 20)
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
setwd("~/GitHub/Covid-prediction-analysis-junling/impactanalysis")
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
ue.ts.isr <- ts(ue.isr$Value)
plot(ue.ts.isr ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(2,10))
axis(1, at=seq(1, ue.len),labels=ue$TIME, cex.axis = 0.6, las="2")
head(ue.isr)
dim(ue.isr)
ue.ts.isr <- ts(ue.isr$Value)
dim(ue.ts.isr)
ue.isr <- read.csv(file="../data/impact/unemploymentISR.csv")
head(us.isr)
head(ue.isr)
dim(ue.isr)
plot(ts(ue.isr) ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(2,10))
axis(1, at=seq(1, 62),labels=ue$TIME, cex.axis = 0.6, las="2")
ue.ts <- ts(ue.isr)
plot(ue.ts ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(2,10))
ue.ts
ue.ts <- ts(ue$Value)
ue.ts <- ts(ue.isr$Value)
ue.ts
ue.len = length(ue.ts)
plot(ue.ts ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n",ylim=c(2,10))
axis(1, at=seq(1, ue.len),labels=ue$TIME, cex.axis = 0.6, las="2")
plot(ue.ts ,type="l",col="red", xlab="Month", ylab="unemployment rate", main="OECD HUR",xaxt="n",ylim=c(2,10))
plot(ue.ts ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(2,10))
plot(ue.ts ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(2,8))
plot(ue.ts ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(2,7))
plot(ue.ts ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(3,7))
plot(ue.ts ,type="l",col="blue", xlab="Month", ylab="unemployment rate", main="OECD HUR(ISR)",xaxt="n",ylim=c(3,6))
axis(1, at=seq(1, ue.len),labels=ue.isr$TIME, cex.axis = 0.6, las="2")
abline(v=which(ue.isr$TIME == "2020-04"),col="grey",lty="dashed", lwd=2)
abline(v=which(ue.isr$TIME == "2020-04")-1,col="grey",lty="dashed", lwd=2)
