knitr::opts_chunk$set(echo = TRUE)
library(TSA)
library(tseries)
zoom <- read.csv(file="multiTimeline.csv")
zoom.ts <- ts(zoom[,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=1)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(diff(log(zoom.ts)))
acf(zoom.ts)
pacf(zoom.ts)
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome-1] <- 1
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step))
m
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
acf(resid(m)[-1])
pacf(resid(m)[-1])
adf.test(m$residuals)
Box.test(m$residuals, lag = 50, type = "Ljung-Box")
12:20
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome:zoom.length] <- (stayathome:zoom.length) - (stayathome-1)
ramp
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
acf(resid(m)[-1])
pacf(resid(m)[-1])
adf.test(m$residuals)
Box.test(m$residuals, lag = 50, type = "Ljung-Box")
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
adf.test(m$residuals)
Box.test(m$residuals, lag = 100, type = "Ljung-Box")
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
m<-arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m
library(TSA)
library(urca)
library(tseries)
zoom <- read.csv(file="multiTimeline.csv")
zoom.ts <- ts(zoom[,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=1)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
adf.test(zoom.ts)
adf.test(log(zoom.ts))
plot(diff(log(zoom.ts)))
acf(zoom.ts)
pacf(zoom.ts)
adf.test(zoom.ts)
adf.test(log(zoom.ts))
ur.kpss(zoom.ts)
ur.kpss(log(zoom.ts))
adf.test(zoom.ts)
adf.test(log(zoom.ts))
summary(ur.kpss(zoom.ts))
summary(ur.kpss(log(zoom.ts)))
plot(diff(log(zoom.ts)))
acf(zoom.ts)
pacf(zoom.ts)
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome:zoom.length] <- (stayathome:zoom.length) - (stayathome-1)
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
acf(resid(m)[-1])
pacf(resid(m)[-1])
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
summary(ur.kpss(m$residuals))
1:15
adf.test(zoom.ts[1:(stayathome-4)])
adf.test(log(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
adf.test(diff(zoom.ts[1:(stayathome-4)]))
adf.test(log(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
adf.test(zoom.ts[1:(stayathome-4)])
adf.test(diff(log(zoom.ts[1:(stayathome-4)])))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
adf.test(diff(diff(zoom.ts[1:(stayathome-4)])))
adf.test(diff(log(zoom.ts[1:(stayathome-4)])))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
summary(ur.kpss(m$residuals))
adf.test(zoom.ts[1:(stayathome-4)])
adf.test(log(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
acf(resid(m)[-1])
pacf(resid(m)[-1])
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome:zoom.length] <- (stayathome:zoom.length) - (stayathome-1)
plot(diff(log(zoom.ts)))
acf(zoom.ts)
pacf(zoom.ts)
min(which(zoom[,1] >= "2020-03-16"))-1
zoom[min(which(zoom[,1] >= "2020-03-16"))-1,1]
zoom <- read.csv(file="multiTimeline.csv")
zoom.ts <- ts(zoom[,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
policyend <- min(which(zoom[,1] >= "2022-02-28"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=1)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
abline(v=policyend,col="grey",lty="dashed", lwd=2)
zoom <- read.csv(file="multiTimeline.csv")
zoom.ts <- ts(zoom[,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
policyend <- min(which(zoom[,1] >= "2022-01-01"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=1)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
abline(v=policyend,col="grey",lty="dashed", lwd=2)
1:10
zoom <- read.csv(file="multiTimeline.csv")
policyend <- min(which(zoom[,1] >= "2022-01-01"))-1
zoom.ts <- ts(zoom[1:policyend,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=1)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
zoom <- read.csv(file="multiTimeline.csv")
zoom <- zoom[(1:min(which(zoom[,1] >= "2022-01-01"))-1),]
zoom.ts <- ts(zoom[1:policyend,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=1)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
adf.test(zoom.ts)
adf.test(log(zoom.ts))
summary(ur.kpss(zoom.ts))
summary(ur.kpss(log(zoom.ts)))
adf.test(zoom.ts[1:(stayathome-4)])
adf.test(log(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
plot(diff(log(zoom.ts)))
acf(zoom.ts)
pacf(zoom.ts)
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome:zoom.length] <- (stayathome:zoom.length) - (stayathome-1)
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
acf(resid(m)[-1])
pacf(resid(m)[-1])
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
summary(ur.kpss(m$residuals))
zoom <- read.csv(file="multiTimeline.csv")
zoom <- zoom[(1:min(which(zoom[,1] >= "2022-01-01"))-1),]
zoom.ts <- ts(zoom[1:policyend,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=0.5)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=0.5,size=1)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n", cex.axis = 0.5)
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=0.5)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n", cex.axis = 0.2)
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=0.5)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], font=0.5, cex.axis = 0.2)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], cex.axis = 0.2)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], cex.axis = 0.5)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], cex.axis = 0.5)
abline(v=stayathome,col="grey",lty="dashed", lwd=2，las="2")
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], cex.axis = 0.5)
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], cex.axis = 0.5, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 10),labels=zoom[seq(1,zoom.length,10), 1], cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=zoom[seq(1,zoom.length,5), 1], cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
substring(c("123456","12345","1234"),3)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(log(zoom.ts), ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(log(zoom.ts),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome:zoom.length] <- (stayathome:zoom.length) - (stayathome-1)
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m
acf(resid(m)[-1])
pacf(resid(m)[-1])
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
summary(ur.kpss(m$residuals))
m<-arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals)
plot(m$residuals,ylab="residuals")
plot(m$residuals,ylab="residuals", xlab="weeks")
plot(m$residuals,ylab="residuals", xlab="weeks")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(m$residuals,ylab="residuals", xlab="weeks",xart="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(m$residuals,ylab="residuals", xlab="weeks",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(m$residuals,ylab="residuals", xlab="weeks",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
acf(resid(m)[-1])
pacf(resid(m)[-1])
acf(resid(m)[-1],lag=30)
pacf(resid(m)[-1],lag=30)
acf(resid(m)[-1],lag=50)
pacf(resid(m)[-1],lag=50)
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
adf.test(m$residuals)
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
summary(ur.kpss(m$residuals))
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
(1-0.05)^50
resid(m)
resid(m,type="devariance")
? resid
plot(resid(m,type="devariance"))
plot(resid(m,type="variance"))
resid(m,type="devariance1")
resid(m,type="de")
m.ar3<-arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m
m.ar3<-arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m
m.ar3<-arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m.ar3
time = 1:zoom.length
m.full <- arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
m.full
time = 1:zoom.length
m.full <- arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp, time))
m.full
time = 1:zoom.length
m.full <- arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
m.full
time = 1:zoom.length
m.full <- arimax(log(zoom.ts), order=c(1, 0, 0), xreg = data.frame(step, ramp, time))
m.full
time = 1:zoom.length
m.full <- arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
m.full
time = 1:zoom.length
m.full <- arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m.full
time = 1:zoom.length
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
m
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals,ylab="residuals", xlab="weeks",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(m$residuals,ylab="residuals", xlab="weeks",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
m.ar3<-arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m.ar3
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 50, type = "Ljung-Box")
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 60, type = "Ljung-Box")
m.stable <- arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m.stable
? anova
arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:stayathome-4]))
arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
arimax(log(zoom.ts[1:(stayathome-4)]), order=c(3, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time=time[1:(stayathome-4)]))
arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
m.nocovid <- arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
ur.kpss(m.nocovid$residuals)
m.nocovid <- arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
summary(ur.kpss(m.nocovid$residuals))
m.nocovid <- arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
m.nocovid
summary(ur.kpss(m.nocovid$residuals))
m.nocovid <- arimax(log(zoom.ts[1:(stayathome-4)]), order=c(0, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
m.nocovid
summary(ur.kpss(m.nocovid$residuals))
m.nocovid <- arimax(log(zoom.ts[1:(stayathome-4)]), order=c(2, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
m.nocovid
summary(ur.kpss(m.nocovid$residuals))
m.nocovid <- arimax(log(zoom.ts[1:(stayathome-4)]), order=c(0, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
m.nocovid
summary(ur.kpss(m.nocovid$residuals))
anova(m, m.stable)
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
knitr::opts_chunk$set(echo = TRUE)
library(TSA)
library(urca)
library(tseries)
zoom <- read.csv(file="../impact/zoomSwiss.csv")
zoom <- read.csv(file="../impact/zoomSwiss.csv")
setwd("~/GitHub/Covid-prediction-analysis-junling/impactanalysis")
zoom <- read.csv(file="../impact/zoomSwiss.csv")
zoom <- read.csv(file="..\impact\zoomSwiss.csv")
zoom <- read.csv(file="../impact/zoomSwiss.csv")
zoom <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom <- zoom[(1:min(which(zoom[,1] >= "2022-01-01"))-1),]
zoom.ts <- ts(zoom[1:policyend,2])
zoom <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom <- zoom[(1:min(which(zoom[,1] >= "2022-01-01"))-1),]
policyend <- min(which(zoom[,1] >= "2022-01-01"))-1
zoom.ts <- ts(zoom[1:policyend,2])
zoom <- read.csv(file="../data/impact/zoomSwiss.csv")
zoom <- zoom[(1:min(which(zoom[,1] >= "2022-01-01"))-1),]
zoom.ts <- ts(zoom[,2])
zoom.length <- dim(zoom)[1]
stayathome <- min(which(zoom[,1] >= "2020-03-16"))-1
plot(zoom.ts, ylim=c(0,105),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
plot(log(zoom.ts),type="l",col="blue", xlab="Week", ylab="search popularity", main="Google Search Trend for Zoom(Swiss)",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
adf.test(zoom.ts)
adf.test(log(zoom.ts))
summary(ur.kpss(zoom.ts))
summary(ur.kpss(log(zoom.ts)))
adf.test(zoom.ts[1:(stayathome-4)])
adf.test(log(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(zoom.ts[1:(stayathome-4)]))
summary(ur.kpss(log(zoom.ts[1:(stayathome-4)])))
step <- rep(0,zoom.length)
step[stayathome:zoom.length] <- 1
pulse <- rep(0,zoom.length)
pulse[stayathome] <- 1
ramp <- rep(0, zoom.length)
ramp[stayathome:zoom.length] <- (stayathome:zoom.length) - (stayathome-1)
time = 1:zoom.length
m<-arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp, time))
m
plot(fitted(m), col="red")
lines(log(zoom.ts), col="blue")
plot(m$residuals,ylab="residuals", xlab="weeks",xaxt="n")
axis(1, at=seq(1, zoom.length, 5),labels=substring(zoom[seq(1,zoom.length,5), 1],3), cex.axis = 0.4, las="2")
abline(v=stayathome,col="grey",lty="dashed", lwd=2)
acf(resid(m)[-1],lag=50, main="residuals")
pacf(resid(m)[-1],lag=50, main="residuals")
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 60, type = "Ljung-Box")
m.ar3<-arimax(log(zoom.ts), order=c(3, 0, 0), xreg = data.frame(step, ramp))
m.ar3
m.stable <- arimax(log(zoom.ts), order=c(2, 0, 0), xreg = data.frame(step, ramp))
m.stable
m.nocovid <- arimax(log(zoom.ts[1:(stayathome-4)]), order=c(0, 0, 0), xreg = data.frame(time[1:(stayathome-4)]))
m.nocovid
summary(ur.kpss(m.nocovid$residuals))
? arimax
m.stable <- arimax(log(zoom.ts), order=c(2, 0, 0), seasonal=list(order=c(1,0,0),period=52), xreg = data.frame(step, ramp))
m.stable
1.022/0.0663
0.1022/0.0663
m.season <- arimax(log(zoom.ts), order=c(2, 0, 0), seasonal=list(order=c(1,0,0),period=52), xreg = data.frame(step, ramp))
m.season
confint(m.season)
m.season <- arimax(log(zoom.ts), order=c(2, 0, 0), seasonal=list(order=c(1,0,0),period=52), xreg = data.frame(step, ramp))
m.season
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 60, type = "Ljung-Box")
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 80, type = "Ljung-Box")
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 100, type = "Ljung-Box")
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 80, type = "Ljung-Box")
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 60, type = "Ljung-Box")
conf(m.season)
confint(m.season)
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 60, type = "Ljung-Box")
m.season <- arimax(log(zoom.ts), order=c(2, 0, 0), seasonal=list(order=c(1,0,0),period=52), xreg = data.frame(step, ramp,time))
m.season
m.season <- arimax(log(zoom.ts), order=c(2, 0, 0), seasonal=list(order=c(1,0,0),period=52), xreg = data.frame(step, ramp,time))
m.season
confint(m.season)
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 60, type = "Ljung-Box")
confint(m.season)
adf.test(m.season$residuals)
summary(ur.kpss(m.season$residuals))
Box.test(m.season$residuals, lag = 80, type = "Ljung-Box")
adf.test(m$residuals)
summary(ur.kpss(m$residuals))
Box.test(m$residuals, lag = 80, type = "Ljung-Box")
